# Gunicorn server
upstream django {
  server  0.0.0.0:80;
}

server {
  listen 80;
  server_name www.0.0.0.0;
  rewrite ^/(.*) http://0.0.0.0/$1 permanent;
}

server {
    listen 80 default_server;
    listen [::]:80 default_server ipv6only=on;
    server_name 0.0.0.0;
	root        /home/ubuntu/ieeewebsite;
	access_log  /var/log/nginx/ieeewebsite.access.log;
	error_log  /var/log/nginx/ieeewebsite.error.log;
	
	try_files $uri @django;

	# Setup named location for Django requests and handle proxy details
	location @django {
		proxy_pass         http://django;
		proxy_redirect     off;
		proxy_set_header   Host             $host;
		proxy_set_header   X-Real-IP        $remote_addr;
		proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
	}
}